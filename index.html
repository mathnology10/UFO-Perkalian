<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UFO Perkalian 2</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    
    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }
    
    @keyframes shootingStar {
      0% { transform: translateX(0) translateY(0); opacity: 1; }
      100% { transform: translateX(-200px) translateY(200px); opacity: 0; }
    }
    
    @keyframes floatUFO {
      0% { transform: translateX(0) translateY(0) rotate(-2deg); }
      25% { transform: translateX(20px) translateY(-15px) rotate(2deg); }
      50% { transform: translateX(40px) translateY(0) rotate(-2deg); }
      75% { transform: translateX(20px) translateY(15px) rotate(2deg); }
      100% { transform: translateX(0) translateY(0) rotate(-2deg); }
    }
    
    @media (min-width: 640px) {
      @keyframes floatUFO {
        0% { transform: translateX(0) translateY(0) rotate(-2deg); }
        25% { transform: translateX(40px) translateY(-30px) rotate(2deg); }
        50% { transform: translateX(80px) translateY(0) rotate(-2deg); }
        75% { transform: translateX(40px) translateY(30px) rotate(2deg); }
        100% { transform: translateX(0) translateY(0) rotate(-2deg); }
      }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    @keyframes explode {
      0% { transform: scale(1) rotate(0deg); opacity: 1; }
      50% { transform: scale(1.5) rotate(180deg); opacity: 0.5; }
      100% { transform: scale(0) rotate(360deg); opacity: 0; }
    }
    
    @keyframes correctPulse {
      0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
      50% { transform: scale(1.1); box-shadow: 0 0 0 20px rgba(34, 197, 94, 0); }
      100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
    }
    
    @keyframes wrongShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes rocketFloat {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }
    
    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s infinite ease-in-out;
    }
    
    .shooting-star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8);
      animation: shootingStar 2s linear infinite;
    }
    
    .ufo {
      position: absolute;
      cursor: pointer;
      transition: transform 0.2s ease;
      animation: floatUFO 5s ease-in-out infinite;
    }
    
    .ufo:hover {
      transform: scale(1.15) !important;
      z-index: 10;
    }
    
    .ufo.exploding {
      animation: explode 0.6s ease-out forwards !important;
    }
    
    .correct-feedback {
      animation: correctPulse 0.5s ease-out;
    }
    
    .wrong-feedback {
      animation: wrongShake 0.5s ease-out;
    }
    
    .fade-in-up {
      animation: fadeInUp 0.5s ease-out forwards;
    }
    
    .rocket-ship {
      animation: rocketFloat 3s ease-in-out infinite;
    }
    
    .planet {
      border-radius: 50%;
      position: absolute;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full w-full">
  <div id="app" class="h-full w-full relative" style="background: linear-gradient(to bottom, #0a0e27 0%, #1a1f4d 50%, #2d1b4e 100%);"><!-- Animated Background -->
   <div id="stars" class="absolute inset-0 overflow-hidden"></div><!-- Game Container -->
   <div class="relative h-full w-full flex flex-col"><!-- Header -->
    <header class="relative z-20 px-4 py-3" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(59, 130, 246, 0.3)); backdrop-filter: blur(10px); border-bottom: 2px solid rgba(255, 255, 255, 0.1);">
     <div class="max-w-7xl mx-auto">
      <div class="flex justify-between items-center mb-2">
       <div class="flex-1">
        <h1 id="gameTitle" class="text-lg sm:text-2xl font-bold text-white mb-1" style="text-shadow: 0 0 20px rgba(139, 92, 246, 0.8);">üõ∏ UFO Perkalian</h1>
        <p id="instructionText" class="text-xs sm:text-sm text-purple-200">Klik UFO dengan jawaban yang benar!</p>
       </div>
       <div class="flex items-center gap-2 sm:gap-4">
        <div class="text-center">
         <div class="text-xs text-purple-200 mb-1">
          üìù Soal
         </div>
         <div id="questionNumber" class="text-xl sm:text-3xl font-bold text-cyan-300" style="text-shadow: 0 0 20px rgba(34, 211, 238, 0.8);">
          1/10
         </div>
        </div>
        <div class="text-center">
         <div class="text-xs text-purple-200 mb-1">
          ‚≠ê Skor
         </div>
         <div id="score" class="text-xl sm:text-3xl font-bold text-yellow-300" style="text-shadow: 0 0 20px rgba(253, 224, 71, 0.8);">
          0
         </div>
        </div>
       </div>
      </div>
     </div>
    </header><!-- Main Game Area -->
    <main class="flex-1 relative overflow-hidden"><!-- Decorative Planets -->
     <div class="planet hidden sm:block" style="width: 80px; height: 80px; background: radial-gradient(circle at 30% 30%, #f59e0b, #dc2626); top: 15%; right: 10%; opacity: 0.6; box-shadow: 0 0 40px rgba(245, 158, 11, 0.5);"></div>
     <div class="planet hidden sm:block" style="width: 120px; height: 120px; background: radial-gradient(circle at 30% 30%, #3b82f6, #1e40af); bottom: 20%; left: 8%; opacity: 0.5; box-shadow: 0 0 60px rgba(59, 130, 246, 0.5);"></div><!-- Start Screen -->
     <div id="startScreen" class="absolute inset-0 flex items-center justify-center z-30 px-4 overflow-y-auto" style="background: rgba(10, 14, 39, 0.95); backdrop-filter: blur(10px);">
      <div class="text-center fade-in-up py-8 w-full max-w-lg">
       <div class="text-5xl sm:text-7xl mb-3 sm:mb-4 rocket-ship">
        üöÄ
       </div>
       <h2 class="text-2xl sm:text-4xl font-bold text-white mb-2 sm:mb-3" style="text-shadow: 0 0 30px rgba(139, 92, 246, 1);">UFO Perkalian</h2>
       <p class="text-sm sm:text-lg text-purple-200 mb-6 sm:mb-8 max-w-md mx-auto px-4">Pilih perkalian yang ingin kamu latih! üåü</p><!-- Multiplication Selection -->
       <div class="mb-6">
        <div class="text-base sm:text-xl font-semibold text-white mb-4">
         Pilih Perkalian:
        </div>
        <div class="grid grid-cols-5 gap-2 sm:gap-3 max-w-md mx-auto px-4"><button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="1" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">1</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="2" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">2</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="3" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">3</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="4" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">4</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="5" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">5</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="6" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">6</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="7" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">7</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="8" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">8</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="9" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">9</button> <button class="multiplication-btn text-lg sm:text-2xl font-bold py-3 sm:py-4 rounded-xl text-white transition-all transform active:scale-95" data-value="10" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8)); border: 2px solid rgba(255, 255, 255, 0.3);">10</button>
        </div>
       </div>
       <div id="selectedMultiplication" class="text-lg sm:text-2xl font-bold text-yellow-300 mb-6" style="text-shadow: 0 0 20px rgba(253, 224, 71, 0.8);">
        Pilih perkalian di atas
       </div><button id="startBtn" class="text-lg sm:text-xl font-bold px-8 sm:px-12 py-4 sm:py-5 rounded-full text-white transition-all transform hover:scale-110 active:scale-95 opacity-50 cursor-not-allowed" style="background: linear-gradient(135deg, #8b5cf6, #3b82f6); box-shadow: 0 10px 40px rgba(139, 92, 246, 0.6);" disabled> ‚ñ∂Ô∏è Mulai Bermain </button>
      </div>
     </div><!-- Question Display -->
     <div id="questionContainer" class="hidden absolute top-4 sm:top-8 left-1/2 transform -translate-x-1/2 z-20 fade-in-up px-4 w-full max-w-lg">
      <div class="px-6 sm:px-10 py-4 sm:py-6 rounded-2xl text-center" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.9), rgba(59, 130, 246, 0.9)); backdrop-filter: blur(10px); box-shadow: 0 10px 50px rgba(139, 92, 246, 0.5); border: 2px solid rgba(255, 255, 255, 0.2);">
       <div class="text-sm sm:text-lg font-semibold text-purple-200 mb-1 sm:mb-2">
        Berapa hasil dari:
       </div>
       <div id="question" class="text-4xl sm:text-6xl font-bold text-white" style="text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);">
        2 √ó 1 = ?
       </div>
      </div>
     </div><!-- Player Rocket -->
     <div id="playerRocket" class="hidden absolute bottom-8 sm:bottom-12 left-1/2 transform -translate-x-1/2 z-20 rocket-ship">
      <div class="text-5xl sm:text-7xl" style="filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.8));">
       üöÄ
      </div>
     </div><!-- UFO Container -->
     <div id="ufoContainer" class="absolute inset-0"></div><!-- Game Over Screen -->
     <div id="gameOverScreen" class="hidden absolute inset-0 flex items-center justify-center z-30 px-4 overflow-y-auto" style="background: rgba(10, 14, 39, 0.95); backdrop-filter: blur(10px);">
      <div class="text-center fade-in-up px-4 sm:px-6 py-8">
       <div class="text-6xl sm:text-8xl mb-4 sm:mb-6">
        üèÜ
       </div>
       <h2 class="text-3xl sm:text-5xl font-bold text-white mb-3 sm:mb-4" style="text-shadow: 0 0 30px rgba(139, 92, 246, 1);">Selesai!</h2>
       <div class="mb-6 sm:mb-8">
        <div class="text-xl sm:text-2xl text-purple-200 mb-2">
         Skor Akhir
        </div>
        <div id="finalScore" class="text-5xl sm:text-7xl font-bold text-yellow-300 mb-3 sm:mb-4" style="text-shadow: 0 0 30px rgba(253, 224, 71, 1);">
         0
        </div>
        <div class="text-base sm:text-xl mb-3"><span class="text-green-300">‚úì Benar: <span id="correctAnswers" class="font-bold">0</span></span> <span class="text-red-300 ml-4">‚úó Salah: <span id="wrongAnswers" class="font-bold">0</span></span>
        </div>
        <div id="resultMessage" class="text-lg sm:text-2xl font-bold text-white mb-4"></div>
       </div><button id="restartBtn" class="text-lg sm:text-xl font-bold px-8 sm:px-12 py-4 sm:py-5 rounded-full text-white transition-all transform hover:scale-110 active:scale-95" style="background: linear-gradient(135deg, #8b5cf6, #3b82f6); box-shadow: 0 10px 40px rgba(139, 92, 246, 0.6);"> üîÑ Main Lagi </button>
      </div>
     </div>
    </main>
   </div>
  </div>
  <script>
    const defaultConfig = {
      game_title: "üõ∏ UFO Perkalian",
      instruction_text: "Klik UFO dengan jawaban yang benar!",
      play_button_text: "‚ñ∂Ô∏è Mulai Bermain",
      restart_button_text: "üîÑ Main Lagi",
      primary_color: "#8b5cf6",
      secondary_color: "#3b82f6",
      background_color: "#0a0e27",
      text_color: "#ffffff",
      accent_color: "#fde047",
      font_family: "system-ui, -apple-system, sans-serif",
      font_size: 16
    };

    let score = 0;
    let selectedMultiplier = null;
    let currentQuestionIndex = 0;
    let correctCount = 0;
    let wrongCount = 0;
    let currentQuestion = { multiplicand: 1, answer: 1 };
    let gameActive = false;
    let ufos = [];
    let usedMultiplicands = [];

    // Create animated stars background
    function createStars() {
      const starsContainer = document.getElementById('stars');
      starsContainer.innerHTML = '';
      
      // Regular stars
      for (let i = 0; i < 100; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.width = Math.random() * 3 + 'px';
        star.style.height = star.style.width;
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.animationDelay = Math.random() * 3 + 's';
        starsContainer.appendChild(star);
      }
      
      // Shooting stars
      for (let i = 0; i < 3; i++) {
        const shootingStar = document.createElement('div');
        shootingStar.className = 'shooting-star';
        shootingStar.style.right = Math.random() * 50 + '%';
        shootingStar.style.top = Math.random() * 50 + '%';
        shootingStar.style.animationDelay = Math.random() * 5 + 's';
        shootingStar.style.animationDuration = (Math.random() * 2 + 1) + 's';
        starsContainer.appendChild(shootingStar);
      }
    }

    function onConfigChange(config) {
      const gameTitle = config.game_title || defaultConfig.game_title;
      const instructionText = config.instruction_text || defaultConfig.instruction_text;
      const playButtonText = config.play_button_text || defaultConfig.play_button_text;
      const restartButtonText = config.restart_button_text || defaultConfig.restart_button_text;
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;

      document.getElementById('gameTitle').textContent = gameTitle;
      document.getElementById('instructionText').textContent = instructionText;
      document.getElementById('startBtn').innerHTML = playButtonText;
      document.getElementById('restartBtn').innerHTML = restartButtonText;
      
      const header = document.querySelector('header');
      header.style.background = `linear-gradient(135deg, rgba(${hexToRgb(primaryColor)}, 0.3), rgba(${hexToRgb(secondaryColor)}, 0.3))`;
      
      const buttons = [document.getElementById('startBtn'), document.getElementById('restartBtn')];
      buttons.forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${primaryColor}, ${secondaryColor})`;
      });
      
      document.getElementById('score').style.color = accentColor;
    }

    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : '139, 92, 246';
    }

    function generateQuestion() {
      let multiplicand;
      
      // Pilih angka 1-10 yang belum digunakan
      const availableNumbers = [];
      for (let i = 1; i <= 10; i++) {
        if (!usedMultiplicands.includes(i)) {
          availableNumbers.push(i);
        }
      }
      
      if (availableNumbers.length === 0) {
        // Jika semua sudah digunakan, reset
        usedMultiplicands = [];
        multiplicand = Math.floor(Math.random() * 10) + 1;
      } else {
        // Pilih random dari yang tersedia
        multiplicand = availableNumbers[Math.floor(Math.random() * availableNumbers.length)];
      }
      
      usedMultiplicands.push(multiplicand);
      currentQuestion = { multiplicand: multiplicand, answer: selectedMultiplier * multiplicand };
      document.getElementById('question').textContent = `${selectedMultiplier} √ó ${multiplicand} = ?`;
      document.getElementById('questionNumber').textContent = `${currentQuestionIndex + 1}/10`;
    }

    function generateAnswers() {
      const answers = [currentQuestion.answer];
      const usedAnswers = new Set([currentQuestion.answer]);
      const maxAnswer = selectedMultiplier * 10;
      
      while (answers.length < 3) {
        const offset = Math.floor(Math.random() * 10) - 5;
        const wrongAnswer = currentQuestion.answer + offset;
        if (wrongAnswer > 0 && wrongAnswer <= maxAnswer && !usedAnswers.has(wrongAnswer)) {
          answers.push(wrongAnswer);
          usedAnswers.add(wrongAnswer);
        }
      }
      
      return answers.sort(() => Math.random() - 0.5);
    }

    function createUFO(answer, index) {
      const ufo = document.createElement('div');
      ufo.className = 'ufo';
      
      const isCorrect = answer === currentQuestion.answer;
      const container = document.getElementById('ufoContainer');
      const isMobile = window.innerWidth < 640;
      
      // Define three distinct zones with better spacing
      const zones = [
        { x: 0.2, y: 0.35 },  // Left zone
        { x: 0.5, y: 0.45 },  // Center zone
        { x: 0.78, y: 0.38 }  // Right zone
      ];
      
      const zone = zones[index];
      const spreadX = isMobile ? 0.08 : 0.1;
      const spreadY = isMobile ? 0.12 : 0.15;
      
      const containerWidth = container.clientWidth;
      const containerHeight = container.clientHeight;
      
      // Calculate position with controlled randomness
      const randomX = (zone.x + (Math.random() - 0.5) * spreadX) * containerWidth;
      const randomY = (zone.y + (Math.random() - 0.5) * spreadY) * containerHeight;
      
      ufo.style.left = `${Math.max(20, Math.min(containerWidth - 150, randomX))}px`;
      ufo.style.top = `${Math.max(150, Math.min(containerHeight - 150, randomY))}px`;
      ufo.style.animationDelay = `${index * 0.2}s`;
      ufo.style.animationDuration = `${4 + Math.random() * 2}s`;
      
      const colors = ['#8b5cf6', '#3b82f6', '#06b6d4', '#10b981', '#f59e0b'];
      const ufoColor = colors[Math.floor(Math.random() * colors.length)];
      
      const ufoSize = isMobile ? 'text-4xl' : 'text-6xl';
      const answerSize = isMobile ? 'text-xl px-4 py-2' : 'text-2xl px-6 py-3';
      
      ufo.innerHTML = `
        <div class="text-center">
          <div class="${ufoSize} mb-2" style="filter: drop-shadow(0 0 10px ${ufoColor});">üõ∏</div>
          <div class="font-bold ${answerSize} rounded-full text-white" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.9), rgba(59, 130, 246, 0.9)); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.6); border: 2px solid rgba(255, 255, 255, 0.3);">
            ${answer}
          </div>
        </div>
      `;
      
      ufo.onclick = () => handleUFOClick(ufo, isCorrect);
      
      return { element: ufo, isCorrect: isCorrect };
    }

    function handleUFOClick(ufo, isCorrect) {
      if (!gameActive) return;
      
      ufo.style.pointerEvents = 'none';
      ufo.classList.add('exploding');
      
      if (isCorrect) {
        correctCount++;
        score += 10;
        document.getElementById('score').textContent = score;
        document.getElementById('score').classList.add('correct-feedback');
        
        setTimeout(() => {
          document.getElementById('score').classList.remove('correct-feedback');
        }, 500);
        
        setTimeout(() => {
          ufo.remove();
          currentQuestionIndex++;
          
          if (currentQuestionIndex >= 10) {
            endGame();
          } else {
            nextRound();
          }
        }, 600);
      } else {
        wrongCount++;
        document.getElementById('questionContainer').classList.add('wrong-feedback');
        
        setTimeout(() => {
          document.getElementById('questionContainer').classList.remove('wrong-feedback');
          ufo.remove();
          currentQuestionIndex++;
          
          if (currentQuestionIndex >= 10) {
            endGame();
          } else {
            nextRound();
          }
        }, 600);
      }
    }

    function nextRound() {
      if (!gameActive) return;
      
      ufos.forEach(u => u.element.remove());
      ufos = [];
      
      generateQuestion();
      const answers = generateAnswers();
      const container = document.getElementById('ufoContainer');
      
      answers.forEach((answer, index) => {
        const ufoData = createUFO(answer, index);
        container.appendChild(ufoData.element);
        ufos.push(ufoData);
      });
    }

    function startGame() {
      if (!selectedMultiplier) return;
      
      score = 0;
      currentQuestionIndex = 0;
      correctCount = 0;
      wrongCount = 0;
      usedMultiplicands = [];
      gameActive = true;
      
      document.getElementById('score').textContent = score;
      document.getElementById('questionNumber').textContent = '1/10';
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('questionContainer').classList.remove('hidden');
      document.getElementById('playerRocket').classList.remove('hidden');
      
      nextRound();
    }

    function endGame() {
      gameActive = false;
      document.getElementById('finalScore').textContent = score;
      document.getElementById('correctAnswers').textContent = correctCount;
      document.getElementById('wrongAnswers').textContent = wrongCount;
      
      // Pesan berdasarkan hasil
      let message = '';
      if (correctCount === 10) {
        message = 'üåü SEMPURNA! Kamu hebat! üåü';
      } else if (correctCount >= 7) {
        message = 'üëè Bagus sekali! Terus berlatih!';
      } else if (correctCount >= 5) {
        message = 'üëç Lumayan! Ayo coba lagi!';
      } else {
        message = 'üí™ Jangan menyerah! Coba lagi!';
      }
      document.getElementById('resultMessage').textContent = message;
      
      document.getElementById('gameOverScreen').classList.remove('hidden');
      document.getElementById('questionContainer').classList.add('hidden');
      document.getElementById('playerRocket').classList.add('hidden');
    }

    function resetGame() {
      ufos.forEach(u => u.element.remove());
      ufos = [];
      selectedMultiplier = null;
      document.getElementById('gameOverScreen').classList.add('hidden');
      document.getElementById('startScreen').classList.remove('hidden');
      document.getElementById('selectedMultiplication').textContent = 'Pilih perkalian di atas';
      document.getElementById('startBtn').disabled = true;
      document.getElementById('startBtn').classList.add('opacity-50', 'cursor-not-allowed');
      
      // Reset semua tombol pilihan
      document.querySelectorAll('.multiplication-btn').forEach(btn => {
        btn.classList.remove('ring-4', 'ring-yellow-300');
        btn.style.background = 'linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8))';
      });
    }

    // Event listener untuk tombol pilihan perkalian
    document.querySelectorAll('.multiplication-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const value = parseInt(btn.getAttribute('data-value'));
        selectedMultiplier = value;
        
        // Reset semua tombol
        document.querySelectorAll('.multiplication-btn').forEach(b => {
          b.classList.remove('ring-4', 'ring-yellow-300');
          b.style.background = 'linear-gradient(135deg, rgba(139, 92, 246, 0.8), rgba(59, 130, 246, 0.8))';
        });
        
        // Highlight tombol terpilih
        btn.classList.add('ring-4', 'ring-yellow-300');
        btn.style.background = 'linear-gradient(135deg, rgba(139, 92, 246, 1), rgba(59, 130, 246, 1))';
        
        // Update teks dan enable tombol start
        document.getElementById('selectedMultiplication').textContent = `Perkalian ${value} dipilih! ‚ú®`;
        document.getElementById('startBtn').disabled = false;
        document.getElementById('startBtn').classList.remove('opacity-50', 'cursor-not-allowed');
      });
    });

    document.getElementById('startBtn').addEventListener('click', (e) => {
      e.preventDefault();
      startGame();
    });

    document.getElementById('restartBtn').addEventListener('click', (e) => {
      e.preventDefault();
      resetGame();
    });

    createStars();

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.primary_color || defaultConfig.primary_color,
              set: (value) => {
                config.primary_color = value;
                window.elementSdk.setConfig({ primary_color: value });
              }
            },
            {
              get: () => config.secondary_color || defaultConfig.secondary_color,
              set: (value) => {
                config.secondary_color = value;
                window.elementSdk.setConfig({ secondary_color: value });
              }
            },
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.accent_color || defaultConfig.accent_color,
              set: (value) => {
                config.accent_color = value;
                window.elementSdk.setConfig({ accent_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ["game_title", config.game_title || defaultConfig.game_title],
          ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
          ["play_button_text", config.play_button_text || defaultConfig.play_button_text],
          ["restart_button_text", config.restart_button_text || defaultConfig.restart_button_text]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b02cc54f53cfdc7',t:'MTc2NjEwNDI5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
